###缓存
####缓存穿透
- 定义：查询一个一定不存在的的数据，由于缓存不被命中，请求将打到DB层，这将导致大量服务同时请求到DB层，造成DB崩溃
- 解决：
   - 采用布隆过滤器，过滤数据一定不存在的请求的
   - 查询结果为空的时候，将空结果进行缓存，设置过期时间(小于等于5min)

####缓存雪崩
- 定义：同一时间有**大量缓存过期失效**，请求在某一刻全部打到DB上
- 解决：在失效时间的基础上增加一个随机值，降低失效时间重复的概率

####缓存击穿
- 定义：对于一些设置了过期时间的key，如果这些key在某个时间点被**大量请求**，增加DB的请求
- 解决：
   - 并发构建缓存，添加互斥锁，只让一个线程构建，其他线程等待
   - 设置不过期缓存：
      - 不设置过期时间
      - 将过期时间存到value中，发现快过期时，异步构建缓存
   - 熔断器资源保护

####缓存预热
- 定义：系统上线后将相关缓存直接加载到缓存中
- 解决：直接写个缓存刷新接口，上线后手动刷新一下

####缓存使用的合理性
- 缓存**热点**数据
- 频繁修改的数据，看情况缓存
- 设置失效时间，允许一段时间内的不一致数据
- 缓存更新机制，一般采用**双删策略+设置过期时间**
- 缓存预热降级

####缓存数据库双写一致性
#####延时双删+设置过期时间
- 先删除缓存
- 更新数据库
- 线程睡眠一段时间
- 删除缓存

  